# Server reboots within last 2 hours
- resource: .*
  rule: $boottime > ($now - 7200)
  event: ServerReboot
  severity: INFORM
  group: Server
  count: 1
  value: $boottime
  description: Server rebooted less than 2 hours ago
  graphs: []
  tags: []

# Puppet Resource alert
- resource: .*
  rule: $pup_res_failed > 0
  event: PuppetResFailed
  severity: WARNING
  group: Puppet
  count: 2
  repeat: 4 
  value: $pup_res_failed
  description: Puppet agent failed to update $pup_res_failed out of $pup_res_total resources
  graphs: [pup_res_failed]
  tags: []

- resource: .*
  rule: $pup_res_failed == 0
  event: PuppetResFailed
  severity: NORMAL
  group: Puppet
  count: 2
  repeat: 100
  value: OK
  description: Puppet is updating all $pup_res_total resources
  graphs: [pup_res_failed]
  tags: []

# Puppet Last Run alert
- resource: .*
  rule: $pup_last_run < ($now - 7200)
  event: PuppetLastRun
  severity: MINOR
  group: Puppet
  count: 2
  repeat: 10
  value: $pup_last_run
  description: Puppet agent has not run for at least 2 hours (last puppet run at $pup_last_run)
  graphs: []
  tags: []

- resource: .*
  rule: $pup_last_run > ($now - 7200)
  event: PuppetLastRun
  severity: NORMAL
  group: Puppet
  count: 2
  repeat: 100
  value: $pup_last_run
  description: Puppet agent is OK (last puppet run at $pup_last_run).
  graphs: []
  tags: []

# Ganglia Heartbeat alert
- resource: .*
  rule: $heartbeat < ($now - 300)
  event: GangliaHeartbeat
  severity: WARNING
  group: Ganglia
  count: 2
  repeat: 10
  value: $heartbeat
  description: No heartbeat from Ganglia agent for at least 5 minutes (last received at $heartbeat)
  graphs: []
  tags: []

- resource: .*
  rule: $heartbeat > ($now - 300)
  event: GangliaHeartbeat
  severity: NORMAL
  group: Ganglia
  count: 2
  repeat: 100
  value: $heartbeat
  description: Heartbeat from Ganglia agent OK (last received at $heartbeat)
  graphs: []
  tags: []

