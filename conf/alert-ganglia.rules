[
    {
        "rule":        "$fs_util-boot > 95",
        "target":      ".*",
        "count":       4,
        "repeat":      2,
        "severity":    "MINOR",
        "event":       "FsUtil-Boot",
        "value":       "$fs_util-boot",
        "group":       "OS",
        "description": "Filesystem utilisation of /boot is $fs_util-boot.",
        "graphs":      [ "fs_util-boot" ],
        "tags":        [ ]
    },
    {
        "rule":        "$fs_util-boot < 90",
        "target":      ".*",
        "count":       4,
        "repeat":      100,
        "severity":    "NORMAL",
        "event":       "FsUtil-Boot",
        "value":       "$fs_util-boot",
        "group":       "OS",
        "description": "Filesystem utilisation of /boot is $fs_util-boot.",
        "graphs":      [ "fs_util-boot" ],
        "tags":        [ ]
    },
    {
        "rule":        "$fs_util-rootfs > 95",
        "target":      ".*",
        "count":       4,
        "repeat":      2,
        "severity":    "MINOR",
        "event":       "FsUtil-Root",
        "value":       "$fs_util-rootfs",
        "group":       "OS",
        "description": "Filesystem utilisation of / is $fs_util-rootfs.",
        "graphs":      [ "fs_util-rootfs" ],
        "tags":        [ ]
    },
    {
        "rule":        "$fs_util-rootfs < 90",
        "target":      ".*",
        "count":       4,
        "repeat":      100,
        "severity":    "NORMAL",
        "event":       "FsUtil-Root",
        "value":       "$fs_util-rootfs",
        "group":       "OS",
        "description": "Filesystem utilisation of / is $fs_util-rootfs.",
        "graphs":      [ "fs_util-rootfs" ],
        "tags":        [ ]
    },
    {
        "rule":        "$load_one > $cpu_num * 12",
        "target":      ".*",
        "count":       4,
        "repeat":      10,
        "severity":    "MAJOR",
        "event":       "SystemLoad",
        "value":       "$load_one",
        "group":       "OS",
        "description": "One minute load average of $load_one exceeded threshold.",
        "graphs":      [ "load_one", "load_five", "load_fifteen" ],
        "tags":        [ ]
    },
    {
        "rule":        "$load_one > $cpu_num * 8 and $load_one < $cpu_num * 12",
        "target":      ".*",
        "count":       4,
        "repeat":      10,
        "severity":    "WARNING",
        "event":       "SystemLoad",
        "value":       "$load_one",
        "group":       "OS",
        "description": "One minute load average of $load_one exceeded threshold.",
        "graphs":      [ "load_one", "load_five", "load_fifteen" ],
        "tags":        [ ]
    },
    {
        "rule":        "$load_one < $cpu_num * 8",
        "target":      ".*",
        "count":       4,
        "repeat":      100,
        "severity":    "NORMAL",
        "event":       "SystemLoad",
        "value":       "$load_one",
        "group":       "OS",
        "description": "One minute load average of $load_one is OK.",
        "graphs":      [ "load_one", "load_five", "load_fifteen" ],
        "tags":        [ ]
    },
    {
        "rule":        "$swap_util > 95",
        "target":      ".*",
        "count":       8,
        "repeat":      10,
        "severity":    "MAJOR",
        "event":       "SwapUtil",
        "value":       "$swap_util",
        "group":       "OS",
        "description": "Swap utilisation is $swap_util%.",
        "graphs":      [ "swap_util", "mem_util", "page_out" ],
        "tags":        [ ]
    },
    {
        "rule":        "$swap_util < 90",
        "target":      ".*",
        "count":       2,
        "repeat":      20,
        "severity":    "NORMAL",
        "event":       "SwapUtil",
        "value":       "$swap_util",
        "group":       "OS",
        "description": "Swap utilisation is OK.",
        "graphs":      [ "swap_util", "mem_util", "page_out" ],
        "tags":        [ ]
    },
    {
        "rule":        "$heartbeat < ($now - 300)",
        "target":      ".*",
        "count":       5,
        "repeat":      10,
        "severity":    "WARNING",
        "event":       "GangliaHeartbeat",
        "value":       "$heartbeat",
        "group":       "OS",
        "description": "No heartbeat from Ganglia agent for at least 5 minutes (last received at $heartbeat)",
        "graphs":      [ ],
        "tags":        [ ]
    },
    {
        "rule":        "$heartbeat > ($now - 300)",
        "target":      ".*",
        "count":       2,
        "repeat":      10,
        "severity":    "NORMAL",
        "event":       "GangliaHeartbeat",
        "value":       "$heartbeat",
        "group":       "OS",
        "description": "Heartbeat from Ganglia agent OK (last received at $heartbeat)",
        "graphs":      [ ],
        "tags":        [ ]
    },
    {
        "rule":        "$pup_last_run < ($now - 7200)",
        "target":      ".*",
        "count":       2,
        "repeat":      10,
        "severity":    "MINOR",
        "event":       "PuppetRun",
        "value":       "$pup_last_run",
        "group":       "OS",
        "description": "Puppet agent has not run for at least 2 hours (last run at $pup_last_run)",
        "graphs":      [ ],
        "tags":        [ ]
    },
    {
        "rule":        "$pup_last_run > ($now - 7200)",
        "target":      ".*",
        "count":       2,
        "repeat":      100,
        "severity":    "NORMAL",
        "event":       "PuppetRun",
        "value":       "$pup_last_run",
        "group":       "OS",
        "description": "Puppet agent is OK (last puppet run at $pup_last_run)",
        "graphs":      [ ],
        "tags":        [ ]
    },
    {
        "rule":        "$pup_res_failed > 0",
        "target":      ".*",
        "count":       2,
        "repeat":      2,
        "severity":    "WARNING",
        "event":       "PuppetResFailed",
        "value":       "$pup_res_failed",
        "group":       "OS",
        "description": "Puppet agent failed to update $pup_res_failed resource(s).",
        "graphs":      [ ],
        "tags":        [ ]
    },
    {
        "rule":        "$pup_last_run == 0",
        "target":      ".*",
        "count":       2,
        "repeat":      100,
        "severity":    "NORMAL",
        "event":       "PuppetResFailed",
        "value":       "$pup_res_failed",
        "group":       "OS",
        "description": "Puppet agent is not failing to update any resources.",
        "graphs":      [ ],
        "tags":        [ ]
    }
]
